{"ast":null,"code":"var _jsxFileName = \"A:\\\\Cours\\\\NodeJs\\\\projet\\\\projet\\\\collab\\\\front\\\\src\\\\components\\\\Login\\\\Login.jsx\",\n  _s = $RefreshSig$();\nimport './login.scss';\nimport { fetchPost } from \"../../components/fetch\";\nimport React, { useContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport AppContext from \"../../context/AppContext\";\nimport { Button, TextField } from \"@mui/material\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Login = _ref => {\n  _s();\n  let {\n    setSessionToken\n  } = _ref;\n  // Hook de navigation\n  const navigate = useNavigate();\n\n  // On récupère les variables d'environnement\n  const {\n    REACT_APP_LOGIN\n  } = process.env;\n\n  // On récupère le context\n  const {\n    openSuccess,\n    setOpenSuccess,\n    openError,\n    setOpenError,\n    handleCloseSuccess,\n    handleCloseError\n  } = useContext(AppContext);\n\n  // On définit un state par défaut pour les credentials\n  const emptyCredentials = {\n    username: '',\n    password: ''\n  };\n\n  // Tous les states de Login.jsx\n  const [credentials, setCredentials] = useState(emptyCredentials);\n\n  // Fonction de login\n  const handleLogin = async e => {\n    e.preventDefault();\n    try {\n      await fetchPost(REACT_APP_LOGIN, credentials).then(res => {\n        // Si le login est correct, on stocke le token dans le localStorage et on redirige vers la page d'accueil\n        if (res.status === true) {\n          localStorage.setItem('token', res.token);\n          setSessionToken(res.token);\n          setOpenSuccess(true);\n          navigate('/');\n        }\n        // Sinon on affiche un message d'erreur et on réinitialise les champs\n        else {\n          setOpenError(true);\n          navigate('/login');\n          throw new Error(res.message);\n        }\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  // Fonction de mise à jour du formulaire\n  const handleChange = e => {\n    setCredentials({\n      ...credentials,\n      [e.target.id]: e.target.value\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"login\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"login__container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"login__container__wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          action: \"/login\",\n          method: \"POST\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"login__container__wrapper__input\",\n            children: [/*#__PURE__*/_jsxDEV(TextField, {\n              id: \"username\",\n              className: \"formInput\",\n              label: \"Username\",\n              color: \"primary\",\n              onChange: e => handleChange(e)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 69,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(TextField, {\n              id: \"password\",\n              className: \"formInput\",\n              label: \"Password\",\n              type: \"password\",\n              color: \"primary\",\n              onChange: e => handleChange(e)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 70,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"outlined\",\n            type: \"submit\",\n            className: \"login__container__wrapper__button\",\n            onClick: e => handleLogin(e),\n            children: \"Log in\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n          open: openSuccess,\n          autoHideDuration: 6000,\n          onClose: handleCloseSuccess,\n          children: /*#__PURE__*/_jsxDEV(Alert, {\n            onClose: handleCloseSuccess,\n            severity: \"error\",\n            sx: {\n              width: '100%'\n            },\n            children: \"You've successfully signed out !\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Snackbar, {\n          open: openError,\n          autoHideDuration: 6000,\n          onClose: handleCloseError,\n          children: /*#__PURE__*/_jsxDEV(Alert, {\n            onClose: handleCloseError,\n            severity: \"error\",\n            sx: {\n              width: '100%'\n            },\n            children: \"Logs are incorrect, try again\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_s(Login, \"4ETKQ6Nfq9pSWRAyYagvZ1TJfh8=\", false, function () {\n  return [useNavigate];\n});\n_c = Login;\nexport default Login;\nvar _c;\n$RefreshReg$(_c, \"Login\");","map":{"version":3,"names":["fetchPost","React","useContext","useState","useNavigate","AppContext","Button","TextField","Login","setSessionToken","navigate","REACT_APP_LOGIN","process","env","openSuccess","setOpenSuccess","openError","setOpenError","handleCloseSuccess","handleCloseError","emptyCredentials","username","password","credentials","setCredentials","handleLogin","e","preventDefault","then","res","status","localStorage","setItem","token","Error","message","console","error","handleChange","target","id","value","width"],"sources":["A:/Cours/NodeJs/projet/projet/collab/front/src/components/Login/Login.jsx"],"sourcesContent":["import './login.scss';\r\nimport {fetchPost} from \"../../components/fetch\";\r\nimport React, {useContext, useState} from \"react\";\r\nimport {useNavigate} from \"react-router-dom\";\r\nimport AppContext from \"../../context/AppContext\";\r\nimport {Button, TextField} from \"@mui/material\";\r\n\r\n\r\nconst Login = ({ setSessionToken }) => {\r\n  // Hook de navigation\r\n  const navigate = useNavigate();\r\n\r\n  // On récupère les variables d'environnement\r\n  const { REACT_APP_LOGIN } = process.env;\r\n\r\n  // On récupère le context\r\n  const { openSuccess, setOpenSuccess, openError, setOpenError, handleCloseSuccess, handleCloseError } = useContext(AppContext);\r\n\r\n  // On définit un state par défaut pour les credentials\r\n  const emptyCredentials = {\r\n    username: '',\r\n    password: ''\r\n  }\r\n\r\n  // Tous les states de Login.jsx\r\n  const [credentials, setCredentials] = useState(emptyCredentials);\r\n\r\n  // Fonction de login\r\n  const handleLogin = async(e) => {\r\n    e.preventDefault();\r\n\r\n    try{\r\n      await fetchPost(REACT_APP_LOGIN, credentials)\r\n        .then(res => {\r\n          // Si le login est correct, on stocke le token dans le localStorage et on redirige vers la page d'accueil\r\n          if(res.status === true){\r\n            localStorage.setItem('token', res.token);\r\n            setSessionToken(res.token);\r\n            setOpenSuccess(true);\r\n            navigate('/');\r\n          }\r\n          // Sinon on affiche un message d'erreur et on réinitialise les champs\r\n          else{\r\n            setOpenError(true);\r\n            navigate('/login');\r\n            throw new Error(res.message);\r\n          }\r\n        })\r\n    } catch(e) {\r\n      console.error(e);\r\n    }\r\n  }\r\n\r\n  // Fonction de mise à jour du formulaire\r\n  const handleChange = (e) => {\r\n    setCredentials({\r\n      ...credentials,\r\n      [e.target.id]: e.target.value}\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"login\">\r\n      <div className=\"login__container\">\r\n        <div className=\"login__container__wrapper\">\r\n          <h1>Log in</h1>\r\n          <form action=\"/login\" method=\"POST\">\r\n            <div className=\"login__container__wrapper__input\">\r\n              <TextField id=\"username\" className=\"formInput\" label=\"Username\" color=\"primary\" onChange={(e) => handleChange(e)} />\r\n              <TextField id=\"password\" className=\"formInput\" label=\"Password\" type=\"password\" color=\"primary\" onChange={(e) => handleChange(e)} />\r\n            </div>\r\n            <Button variant=\"outlined\" type=\"submit\" className=\"login__container__wrapper__button\" onClick={(e) => handleLogin(e)}>\r\n              Log in\r\n            </Button>\r\n          </form>\r\n          <Snackbar open={openSuccess} autoHideDuration={6000} onClose={handleCloseSuccess}>\r\n            <Alert onClose={handleCloseSuccess} severity=\"error\" sx={{ width: '100%' }}>\r\n              You've successfully signed out !\r\n            </Alert>\r\n          </Snackbar>\r\n          <Snackbar open={openError} autoHideDuration={6000} onClose={handleCloseError}>\r\n            <Alert onClose={handleCloseError} severity=\"error\" sx={{ width: '100%' }}>\r\n              Logs are incorrect, try again\r\n            </Alert>\r\n          </Snackbar>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}